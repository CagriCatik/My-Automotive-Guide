# Funktionale Spezifikation

Die Authentifizierung und Integritätssicherung sensibler Daten ist notwendig, um die korrekte und sichere Funktionalität der Fahrzeugsysteme zu schützen - dies stellt sicher, dass empfangene Daten von der richtigen ECU stammen und den korrekten Wert haben. Das SecOC-Modul zielt auf ressourceneffiziente und praktikable Authentifizierungsmechanismen für sensible Daten auf der Ebene der PDUs ab. Der in dieser Spezifikation vorgeschlagene Ansatz unterstützt grundsätzlich die Verwendung von symmetrischen und asymmetrischen Methoden zur Authentizitäts- und Integritätssicherung. Beide Methoden zielen grob auf dasselbe Ziel ab und zeigen wesentliche Ähnlichkeiten im Konzept, aber es gibt auch einige Unterschiede aufgrund unterschiedlicher technischer Eigenschaften der zugrunde liegenden Primitiven. Darüber hinaus sind die üblicherweise verwendeten Begriffe für Authentifizierer unterschiedlich. Im Allgemeinen wird der Begriff "Message Authentication Code" (MAC) für symmetrische Ansätze verwendet, während der Begriff Signatur oder digitale Signatur auf asymmetrische Ansätze verweist, die unterschiedliche Eigenschaften und Einschränkungen haben. Um die Darstellung zu erleichtern und die Lesbarkeit zu verbessern, wird folgender Ansatz gewählt: Der folgende Abschnitt beschreibt den technischen Ansatz unter Verwendung von symmetrischen Mechanismen etwas genauer. Hier werden auch die üblichen Begriffe für symmetrische Primitive verwendet. Die Anpassungen, die im Falle eines asymmetrischen Ansatzes vorgenommen werden müssen, werden separat in Abschnitt 7.1.4 angegeben.

## Spezifikation der Sicherheitslösung

Das in diesem Dokument beschriebene SecOC-Modul bietet die Funktionalität, die zur Überprüfung der Authentizität und Aktualität der PDU-basierten Kommunikation zwischen ECUs innerhalb der Fahrzeugarchitektur erforderlich ist. Der Ansatz erfordert, dass sowohl die sendende ECU als auch die empfangende ECU ein SecOC-Modul implementieren. Beide SecOC-Module sind integriert und bieten die oberen und unteren PduR-APIs auf der Sender- und Empfängerseite. Die SecOC-Module auf beiden Seiten interagieren im Allgemeinen mit dem PduR-Modul. Um die Nachrichtenfrische zu gewährleisten, erhalten die SecOC-Module auf der sendenden und empfangenden Seite von einem externen Freshness Manager Frische für jede eindeutig identifizierbare gesicherte I-PDU, d.h. für jede gesicherte Kommunikationsverbindung. Auf der Senderseite erstellt das SecOC-Modul eine gesicherte I-PDU, indem es Authentifizierungsinformationen zum ausgehenden Authentic I-PDU hinzufügt. Die Authentifizierungsinformationen bestehen aus einem Authentifizierer (z.B. Message Authentication Code) und optional einem Freshness-Wert. Unabhängig davon, ob der Freshness-Wert im Payload der Secure I-PDU enthalten ist oder nicht, wird der Freshness-Wert bei der Generierung des Authentifizierers berücksichtigt. Wenn anstelle eines Zeitstempels ein Freshness Counter verwendet wird, sollte der Freshness Counter vom Freshness Manager vor der Bereitstellung der Authentifizierungsinformationen an die Empfängerseite erhöht werden. Auf der Empfängerseite überprüft das SecOC-Modul die Frische und Authentizität des Authentic I-PDU, indem es die Authentifizierungsinformationen überprüft, die vom sendenden SecOC-Modul angehängt wurden. Um die Authentizität und Frische eines Authentic I-PDU zu überprüfen, sollte die an die Empfangsseite SecOC gelieferte gesicherte I-PDU dieselbe gesicherte I-PDU sein, die vom sendenden SecOC geliefert wurde, und die Empfangsseite SecOC sollte Kenntnis über den Freshness-Wert haben, der vom sendenden SecOC bei der Erstellung des Authentifizierers verwendet wurde.

Hauptzweck des SecOC-Moduls ist die Umsetzung der Sicherheitsfunktionalität, die in dieser Spezifikation beschrieben ist.

Grundlegende Entitäten der Sicherheitslösung

Authentifizierter I-PDU und gesicherter I-PDU

Der Begriff Authentic I-PDU bezieht sich auf eine AUTOSAR I-PDU, die vor unbefugter Manipulation und Wiederholungsangriffen geschützt werden muss. Der Payload einer gesicherten I-PDU besteht aus dem Authentic I-PDU und einem Authentifizierer (z.B. Message Authentication Code). Der Payload einer gesicherten I-PDU kann optional den Freshness-Wert enthalten, der zur Erstellung des Authentifizierers (z.B. MAC) verwendet wurde. Die Reihenfolge, in der die Inhalte in der gesicherten I-PDU strukturiert sind, entspricht Abbildung 3.
